openapi: 3.0.3
info:
  title: WASAphoto API
  description: |
    This is the API for the WASAphoto Homework 1 for the WaSa course by 1849661.
  version: 0.0.1

servers:
  - url: http://localhost:3000/v1
    description: Local development server

tags:
  - name: "login"
    description: Endpoint that manages the login
  - name: "chat"
    description: Endpoint that manages chats/messages
  - name: "group"
    description: Endpoint that manages groups
  - name: "search"
    description: Endpoint that manages search
  - name: "user"
    description: Endpoint that manages users
  - name: "ban"
    description: Endpoint that manages banned users
  - name: "followers"
    description: Endpoint that manages followers
  - name: "stream"
    description: Endpoint that manages stream
  - name: "photo"
    description: Endpoint that manages photos
  - name: "comments"
    description: Endpoint that manages comments
  - name: "likes"
    description: Endpoint that manages likes
#=====================================================================================
paths:
  /session:
    post:
      tags: ["login"]
      summary: Logs in the user
      description: |-
        If the user does not exist, it will be created,
        and an identifier is returned.
        If the user exists, the user identifier is returned
      operationId: doLogin
      requestBody:
        description: User details
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/UserLogin"

        required: true
      responses:
        '201':
          description: User log-in action successful
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/LoginReturn"
              example:
                identifier: "abcdef0123456789"
#=====================================================================================
  /users:
    get:
      tags: ["search"]
      summary: Gets the profile of the user with a certain id
      description: A user can find another user's profile only if he's not banned by the latter. Multiple users might match partially the nickname being searched
      operationId: getUserProfile

      parameters: 
        - $ref: "#/components/parameters/query_id"

      responses:
        '200':
          $ref: "#/components/responses/user_found"
        '401':
          $ref: "#/components/responses/unauthorized"
        '404':
          $ref: "#/components/responses/not_found"
        '500':
          $ref: "#/components/responses/internal_server_error"
          
      security:
        - bearerAuth: [] 
#=====================================================================================
  /users/{id}:
    parameters: 
        - $ref: "#/components/parameters/identifier"
        
    get:
      tags: ["user"]
      summary: Retrieves all the info of a profile
      description: Allows the user to obtain a profile complete info (can't be banned by the profile owner)
      operationId: getProfile
      
      responses:
        '200':
          $ref: "#/components/responses/profile"
        '206':
          $ref: "#/components/responses/partial_content"
        '401':
          $ref: "#/components/responses/unauthorized"
        '403':
          $ref: '#/components/responses/forbidden'
        '404':
          $ref: "#/components/responses/not_found"
        '500':
          $ref: "#/components/responses/internal_server_error"
          
      security:
        - bearerAuth: []         

    put:
      tags: ["user"]
      summary: Modifies the user's nickname
      description: Allows the user to modify his own nickname
      operationId: setMyUserName
        
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CompleteProfilePrototype"
            example: 
              nickname: "NickBruhhh"
        required: true

      responses:
        '200':
          $ref: "#/components/responses/profile"
        '401':
          $ref: "#/components/responses/unauthorized"
        '403':
          $ref: '#/components/responses/forbidden'
        '404':
          $ref: "#/components/responses/not_found"
        '500':
          $ref: "#/components/responses/internal_server_error"
          
      security:
        - bearerAuth: [] 
#=====================================================================================
  /users/{id}/photo:
    parameters:
        - $ref: '#/components/parameters/identifier'

    put:
      tags: ["user"]
      summary: Set my profile photo
      description: Uploads/updates the profile photo of the user
      operationId: setMyPhoto

      requestBody:
        content:
          image/*:
            schema:
              description: Raw image bytes (PNG/JPEG/GIF)
              type: string
              format: binary
              minLength: 1
              maxLength: 10485760
        required: true

      responses:
        '201':
          $ref: "#/components/responses/ok"
        '400':
          $ref: "#/components/responses/bad_request"
        '401':
          $ref: "#/components/responses/unauthorized"
        '403':
          $ref: '#/components/responses/forbidden'
        '404':
          $ref: "#/components/responses/not_found"
        '500':
          $ref: "#/components/responses/internal_server_error"

      security:
        - bearerAuth: []

    get:
      tags: ["user"]
      summary: Get user profile photo
      description: Downloads the profile photo (requester must be logged in and not banned by target user)
      operationId: getMyPhoto

      responses:
        '200':
          description: User profile photo
          content:
            image/*:
              schema:
                description: Raw image bytes (PNG/JPEG/GIF)
                type: string
                format: binary
                minLength: 1
                maxLength: 10485760
        '401':
          $ref: "#/components/responses/unauthorized"
        '403':
          $ref: '#/components/responses/forbidden'
        '404':
          $ref: "#/components/responses/not_found"
        '500':
          $ref: "#/components/responses/internal_server_error"

      security:
        - bearerAuth: []
#=====================================================================================
  /users/{id}/banned_users/{banned_user_id}:
    parameters:
        - $ref: "#/components/parameters/banned_user_id"
        - $ref: '#/components/parameters/identifier'
  
    put:
      tags: ["ban"]
      summary: Bans a user
      description: Once a user is blocked he/she won't be able to see anything from whoever banned him/her. That includes comments,likes, photos and the profile of the banning user. Banning multiple times is equivalent to banning a user once
      operationId: banUser
      
      responses:
        '200':
          $ref: "#/components/responses/ok"
        '401':
          $ref: "#/components/responses/unauthorized"
        '403':
          $ref: '#/components/responses/forbidden'
        '404':
          $ref: "#/components/responses/not_found"
        '500':
          $ref: "#/components/responses/internal_server_error"
          
      security:
        - bearerAuth: [] 
    
    delete:
      tags: ["ban"]
      summary: Unbans a user
      description: By removing the ban the unbanned user can see the posts,comments and likes of the user that unbanned him/her
      operationId: unbanUser
      
      responses:
        '200':
          $ref: "#/components/responses/ok"
        '401':
          $ref: "#/components/responses/unauthorized"
        '403':
          $ref: '#/components/responses/forbidden'
        '404':
          $ref: "#/components/responses/not_found"
        '500':
          $ref: "#/components/responses/internal_server_error"
      
      security:
        - bearerAuth: [] 
#=====================================================================================
  /users/{id}/followers/{follower_id}:
    parameters:
        - $ref: "#/components/parameters/follower_id"
        - $ref: '#/components/parameters/identifier'
        
    put:
      tags: ["followers"]
      summary: Follows a certain user
      description: |
        Allows a user (if he's logged in) to follow another user only if the latter didn't ban him. A user can't follow himself and can't follow a user he already follows. Once a user follows another one then his list of "Following" will be updated too
      operationId: followUser
      
      responses:
        '200':
          $ref: "#/components/responses/ok"
        '401':
          $ref: "#/components/responses/unauthorized"
        '403':
          $ref: '#/components/responses/forbidden'
        '404':
          $ref: "#/components/responses/not_found"
        '500':
          $ref: "#/components/responses/internal_server_error"
      
      security:
        - bearerAuth: [] 
          
    delete:
      tags: ["followers"]
      summary: Unfollows a certain user
      description: |
        A user can decide to unfollow another one. He will be able to follow him again in the future
      operationId: unfollowUser
      
      responses:
        '204':
          $ref: "#/components/responses/no_content"
        '401':
          $ref: "#/components/responses/unauthorized"
        '403':
          $ref: '#/components/responses/forbidden'
        '404':
          $ref: "#/components/responses/not_found"
        '500':
          $ref: "#/components/responses/internal_server_error"      
          
      security:
        - bearerAuth: [] 
#=====================================================================================
  /users/{id}/home:
    parameters: 
        - $ref: '#/components/parameters/identifier'
        
    get:
      tags: ["stream"]
      summary: Obtain the stream
      description: Get all the photos (stream) from the following users
      operationId: getMyStream

      responses:
        '200':
          $ref: "#/components/responses/stream"
        '401':
          $ref: "#/components/responses/unauthorized"
        '403':
          $ref: '#/components/responses/forbidden'
        '404':
          $ref: "#/components/responses/not_found"
        '500':
          $ref: "#/components/responses/internal_server_error"
          
      security:
        - bearerAuth: [] 
#=====================================================================================
  /users/{id}/chats:
    parameters:
        - $ref: '#/components/parameters/identifier'

    get:
      tags: ["chat"]
      summary: Get my conversations
      description: Returns the list of chat peers (conversations)
      operationId: getMyConversations

      responses:
        '200':
          description: List of conversations (peers)
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ConversationsList"
        '401':
          $ref: "#/components/responses/unauthorized"
        '403':
          $ref: '#/components/responses/forbidden'
        '404':
          $ref: "#/components/responses/not_found"
        '500':
          $ref: "#/components/responses/internal_server_error"

      security:
        - bearerAuth: []
#=====================================================================================
  /users/{id}/chats/{peer}/messages:
    parameters:
        - $ref: '#/components/parameters/identifier'
        - $ref: '#/components/parameters/peer'

    get:
      tags: ["chat"]
      summary: Get a conversation
      description: Returns the list of messages exchanged with a peer
      operationId: getConversation

      responses:
        '200':
          description: List of messages
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/MessagesList"
        '401':
          $ref: "#/components/responses/unauthorized"
        '403':
          $ref: '#/components/responses/forbidden'
        '404':
          $ref: "#/components/responses/not_found"
        '500':
          $ref: "#/components/responses/internal_server_error"

      security:
        - bearerAuth: []

    post:
      tags: ["chat"]
      summary: Send a message
      description: Sends a message to a peer
      operationId: sendMessage

      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/SendMessage"
        required: true

      responses:
        '201':
          $ref: "#/components/responses/ok"
        '400':
          $ref: "#/components/responses/bad_request"
        '401':
          $ref: "#/components/responses/unauthorized"
        '403':
          $ref: '#/components/responses/forbidden'
        '404':
          $ref: "#/components/responses/not_found"
        '500':
          $ref: "#/components/responses/internal_server_error"

      security:
        - bearerAuth: []
#=====================================================================================
  /users/{id}/chats/{peer}/messages/{message_id}:
    parameters:
        - $ref: '#/components/parameters/identifier'
        - $ref: '#/components/parameters/peer'
        - $ref: '#/components/parameters/message_id'

    delete:
      tags: ["chat"]
      summary: Delete a message
      description: Deletes a message sent by the user (works for direct and group conversations)
      operationId: deleteMessage

      responses:
        '200':
          $ref: "#/components/responses/ok"
        '400':
          $ref: "#/components/responses/bad_request"
        '401':
          $ref: "#/components/responses/unauthorized"
        '403':
          $ref: '#/components/responses/forbidden'
        '404':
          $ref: "#/components/responses/not_found"
        '500':
          $ref: "#/components/responses/internal_server_error"

      security:
        - bearerAuth: []
#=====================================================================================
  /users/{id}/chats/{peer}/messages/{message_id}/comments:
    parameters:
        - $ref: '#/components/parameters/identifier'
        - $ref: '#/components/parameters/peer'
        - $ref: '#/components/parameters/message_id'

    post:
      tags: ["chat"]
      summary: React to a message
      description: Adds or replaces the current user's reaction (emoticon) to a message
      operationId: commentMessage

      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/MessageReaction"
        required: true

      responses:
        '200':
          $ref: "#/components/responses/ok"
        '400':
          $ref: "#/components/responses/bad_request"
        '401':
          $ref: "#/components/responses/unauthorized"
        '403':
          $ref: '#/components/responses/forbidden'
        '404':
          $ref: "#/components/responses/not_found"
        '500':
          $ref: "#/components/responses/internal_server_error"

      security:
        - bearerAuth: []

    delete:
      tags: ["chat"]
      summary: Remove reaction from a message
      description: Removes the current user's reaction from a message
      operationId: uncommentMessage

      responses:
        '204':
          $ref: "#/components/responses/no_content"
        '400':
          $ref: "#/components/responses/bad_request"
        '401':
          $ref: "#/components/responses/unauthorized"
        '403':
          $ref: '#/components/responses/forbidden'
        '404':
          $ref: "#/components/responses/not_found"
        '500':
          $ref: "#/components/responses/internal_server_error"

      security:
        - bearerAuth: []
#=====================================================================================
  /users/{id}/chats/{peer}/messages/{message_id}/forward:
    parameters:
        - $ref: '#/components/parameters/identifier'
        - $ref: '#/components/parameters/peer'
        - $ref: '#/components/parameters/message_id'

    post:
      tags: ["chat"]
      summary: Forward a message
      description: Forwards a message to another conversation (direct user id or group peer id like g-42)
      operationId: forwardMessage

      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ForwardMessage"
        required: true

      responses:
        '204':
          $ref: "#/components/responses/no_content"
        '400':
          $ref: "#/components/responses/bad_request"
        '401':
          $ref: "#/components/responses/unauthorized"
        '403':
          $ref: '#/components/responses/forbidden'
        '404':
          $ref: "#/components/responses/not_found"
        '500':
          $ref: "#/components/responses/internal_server_error"

      security:
        - bearerAuth: []
#=====================================================================================
  /users/{id}/groups:
    parameters:
        - $ref: '#/components/parameters/identifier'

    post:
      tags: ["group"]
      summary: Create a group
      description: Creates a new group conversation with the specified members
      operationId: createGroup

      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CreateGroup"
        required: true

      responses:
        '201':
          description: Group created
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/GroupCreated"
        '400':
          $ref: "#/components/responses/bad_request"
        '401':
          $ref: "#/components/responses/unauthorized"
        '403':
          $ref: '#/components/responses/forbidden'
        '404':
          $ref: "#/components/responses/not_found"
        '500':
          $ref: "#/components/responses/internal_server_error"

      security:
        - bearerAuth: []
#=====================================================================================
  /groups/{group_id}:
    parameters:
        - $ref: '#/components/parameters/group_id'

    put:
      tags: ["group"]
      summary: Set group name
      description: Updates the group name
      operationId: setGroupName

      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/GroupName"
        required: true

      responses:
        '200':
          $ref: "#/components/responses/ok"
        '400':
          $ref: "#/components/responses/bad_request"
        '401':
          $ref: "#/components/responses/unauthorized"
        '403':
          $ref: '#/components/responses/forbidden'
        '404':
          $ref: "#/components/responses/not_found"
        '500':
          $ref: "#/components/responses/internal_server_error"

      security:
        - bearerAuth: []
#=====================================================================================
  /groups/{group_id}/members/{member_id}:
    parameters:
        - $ref: '#/components/parameters/group_id'
        - $ref: '#/components/parameters/member_id'

    put:
      tags: ["group"]
      summary: Add user to group
      description: Adds an existing user to the group
      operationId: addToGroup

      responses:
        '200':
          $ref: "#/components/responses/ok"
        '400':
          $ref: "#/components/responses/bad_request"
        '401':
          $ref: "#/components/responses/unauthorized"
        '403':
          $ref: '#/components/responses/forbidden'
        '404':
          $ref: "#/components/responses/not_found"
        '500':
          $ref: "#/components/responses/internal_server_error"

      security:
        - bearerAuth: []

    delete:
      tags: ["group"]
      summary: Leave group
      description: Removes the requesting user from the group
      operationId: leaveGroup

      responses:
        '204':
          $ref: "#/components/responses/no_content"
        '400':
          $ref: "#/components/responses/bad_request"
        '401':
          $ref: "#/components/responses/unauthorized"
        '403':
          $ref: '#/components/responses/forbidden'
        '404':
          $ref: "#/components/responses/not_found"
        '500':
          $ref: "#/components/responses/internal_server_error"

      security:
        - bearerAuth: []
#=====================================================================================
  /groups/{group_id}/photo:
    parameters:
        - $ref: '#/components/parameters/group_id'

    put:
      tags: ["group"]
      summary: Set group photo
      description: Uploads/updates the group photo
      operationId: setGroupPhoto

      requestBody:
        content:
          image/*:
            schema:
              description: Raw image bytes (PNG/JPEG/GIF)
              type: string
              format: binary
              minLength: 1
              maxLength: 10485760
        required: true

      responses:
        '200':
          $ref: "#/components/responses/ok"
        '400':
          $ref: "#/components/responses/bad_request"
        '401':
          $ref: "#/components/responses/unauthorized"
        '403':
          $ref: '#/components/responses/forbidden'
        '404':
          $ref: "#/components/responses/not_found"
        '500':
          $ref: "#/components/responses/internal_server_error"

      security:
        - bearerAuth: []

    get:
      tags: ["group"]
      summary: Get group photo
      description: Downloads the group photo (members only)
      operationId: getGroupPhoto

      responses:
        '200':
          description: Group photo
          content:
            image/*:
              schema:
                description: Raw image bytes (PNG/JPEG/GIF)
                type: string
                format: binary
                minLength: 1
                maxLength: 10485760
        '401':
          $ref: "#/components/responses/unauthorized"
        '403':
          $ref: '#/components/responses/forbidden'
        '404':
          $ref: "#/components/responses/not_found"
        '500':
          $ref: "#/components/responses/internal_server_error"

      security:
        - bearerAuth: []
#=====================================================================================
  /users/{id}/photos:
    parameters: 
        - $ref: '#/components/parameters/identifier'
        
    post:
      tags: ["photo"]
      summary: Upload a photo
      description: A user can upload one or multiple images on his/her profile
      operationId: uploadPhoto
      
      requestBody:
        content:
          image/*:
            schema:
              $ref: "#/components/schemas/RawPhoto"
            example:
              photo_data: "010110010"
        required: true

      responses:
        '201':
          $ref: "#/components/responses/photo_uploaded"
        '401':
          $ref: "#/components/responses/unauthorized"
        '403':
          $ref: '#/components/responses/forbidden'
        '500':
          $ref: "#/components/responses/internal_server_error"
          
      security:
        - bearerAuth: [] 
#=====================================================================================
  /users/{id}/photos/{photo_id}:
    parameters: 
        - $ref: '#/components/parameters/identifier'
        - $ref: '#/components/parameters/photo_id'
        
        
    get:
      tags: ["photo"]
      summary: Downloads a photo
      description: A user can access a photo if he/she's the owner or if he/she wasn't banned by the owner
      operationId: getPhoto
      
      responses:
        '200':
          $ref: "#/components/responses/photo"
        '401':
          $ref: '#/components/responses/unauthorized'
        '403':
          $ref: '#/components/responses/forbidden'
        '404':
          $ref: "#/components/responses/not_found"
        '500':
          $ref: "#/components/responses/internal_server_error"
          
      security:
        - bearerAuth: [] 
        
    delete:
      tags: ["photo"]
      summary: Deletes a photo
      description: Deletes a user's photo with relative comments and likes
      operationId: deletePhoto
      
      responses:
        '204':
          $ref: "#/components/responses/no_content"
        '401':
          $ref: '#/components/responses/unauthorized'
        '403':
          $ref: '#/components/responses/forbidden'
        '404':
          $ref: "#/components/responses/not_found"
        '500':
          $ref: "#/components/responses/internal_server_error"
          
      security:
        - bearerAuth: [] 
#=====================================================================================
  /users/{id}/photos/{photo_id}/comments:
    parameters: 
        - $ref: '#/components/parameters/identifier'
        - $ref: '#/components/parameters/photo_id'
        
    post:
      tags: ["comments"]
      summary: Add a comment to a photo
      description: Adds a comment to a user's photo. Multiple comments can be made. Owners can comment their own photo
      operationId: commentPhoto
      
      requestBody:
        description: Contains the id of who's commenting and the relative comment
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Comment'
        required: true
      
      responses:
        '201':
          $ref: '#/components/responses/comment_added'
        '401':
          $ref: '#/components/responses/unauthorized'
        '403':
          $ref: '#/components/responses/forbidden'
        '404':
          $ref: "#/components/responses/not_found"
        '500':
          $ref: "#/components/responses/internal_server_error"
          
      security:
        - bearerAuth: [] 
#=====================================================================================
  /users/{id}/photos/{photo_id}/comments/{comment_id}:
    parameters: 
        - $ref: '#/components/parameters/identifier'
        - $ref: '#/components/parameters/photo_id'
        - $ref: '#/components/parameters/comment_id'
        
    delete:
      tags: ["comments"]
      summary: Remove a comment from a photo
      description: Removes a comment from a user's photo. Only the owner of the photo can remove comments
      operationId: uncommentPhoto
      
      responses:
        '200':
          $ref: '#/components/responses/ok'
        '401':
          $ref: '#/components/responses/unauthorized'
        '403':
          $ref: '#/components/responses/forbidden'
        '404':
          $ref: "#/components/responses/not_found"
        '500':
          $ref: "#/components/responses/internal_server_error"
          
      security:
        - bearerAuth: [] 
#=====================================================================================
  /users/{id}/photos/{photo_id}/likes/{like_id}:
    parameters: 
        - $ref: '#/components/parameters/identifier'
        - $ref: '#/components/parameters/photo_id'
        - $ref: '#/components/parameters/like_id'
  
    put:
      tags: ["likes"]
      summary: Add a like to a photo
      description: Adds a like to a user's photo. A user can only like a photo once (multiple likes count as one). Owners can't like their own photos
      operationId: likePhoto
      
      responses:
        '200':
          $ref: '#/components/responses/ok'
        '401':
          $ref: '#/components/responses/unauthorized'
        '403':
          $ref: '#/components/responses/forbidden'
        '404':
          $ref: "#/components/responses/not_found"
        '500':
          $ref: "#/components/responses/internal_server_error"
      
      security:
        - bearerAuth: [] 
    
    delete:
      tags: ["likes"]
      summary: Remove a like from a photo
      description: Removes a like from a user's photo
      operationId: unlikePhoto
      
      responses:
        '204':
          $ref: '#/components/responses/no_content'
        '401':
          $ref: '#/components/responses/unauthorized'
        '403':
          $ref: '#/components/responses/forbidden'
        '404':
          $ref: "#/components/responses/not_found"
        '500':
          $ref: "#/components/responses/internal_server_error"
          
      security:
        - bearerAuth: [] 
#=====================================================================================
#_____________________________________________________________________________________________________
components:

  parameters:

    identifier:
      name: id
      in: path
      description: A user's unique id
      required: true
      schema:
        description: String between 3-16 characters
        type: string
        pattern: '^.*?$'
        example: Marietto64
        minLength: 3
        maxLength: 16
        readOnly: true
#........................................................
    group_id:
      name: group_id
      in: path
      description: Group unique identifier
      required: true
      schema:
        type: integer
        format: int64
        minimum: 1
        example: 42
#........................................................
    member_id:
      name: member_id
      in: path
      description: Group member user identifier
      required: true
      schema:
        description: String between 3-16 characters
        type: string
        pattern: '^.*?$'
        minLength: 3
        maxLength: 16
        example: "abcdef012345"
#........................................................
    message_id:
      name: message_id
      in: path
      description: Message unique identifier
      required: true
      schema:
        type: integer
        format: int64
        minimum: 1
        example: 123
#........................................................
    peer:
      name: peer
      in: path
      description: A chat peer unique identifier
      required: true
      schema:
        description: String between 3-16 characters
        type: string
        pattern: '^.*?$'
        minLength: 3
        maxLength: 16
        example: "abcdef012345"
#........................................................        
    photo_id:
      name: photo_id
      in: path
      description: A photo unique identifier
      required: true
      schema: 
        description: Int64 between 0-9999
        type: integer
        format: int64
        minimum: 0
        maximum: 9999
        example : 999
        readOnly: true
#........................................................      
    comment_id:
      name: comment_id
      in: path
      description: A comment unique identifier
      required: true
      schema:
        $ref: "#/components/schemas/CommentIdentifier/properties/commentId"
      example: 118
#........................................................        
    follower_id:
      name: follower_id
      in: path
      description: A follower's unique identifier. It's exactly his *identifier*
      required: true
      schema: 
        $ref: "#/components/schemas/CompleteProfilePrototype/properties/nickname"
      example: "Piccioni"
#........................................................       
    like_id:
      name: like_id
      in: path
      description: A like unique identifier. It's exactly the *identifier* of the user that liked the photo
      required: true
      schema: 
        $ref: "#/components/schemas/CompleteProfilePrototype/properties/nickname"
      example: "LauraZ"
#........................................................       
    banned_user_id:
      name: banned_user_id
      in: path
      description: A banned user unique identifier. It's exactly the *identifier* of the user
      required: true
      schema:
        $ref: "#/components/schemas/CompleteProfilePrototype/properties/nickname"
      example: "Akille"
#........................................................      
    query_id:
      name: id
      in: query
      description: id of the user that is being searched
      schema:
        description: usual *identifier*
        type: string
        pattern: '^.*?$'
        minLength: 3
        maxLength: 16
        example: "Luis64"
      example: "luigi64"
#........................................................  
#_____________________________________________________________________________________________________
  schemas:

    CompleteProfilePrototype:
      description: It's a user's nickname
      type: object
      properties:
        nickname:
          description: Any string between 3-16 characters
          type: string
          minLength: 3
          maxLength: 16
          pattern: '^.*?$'
          example: "PulpFiction"
      example:
        nickname: "PolpoFizione"
#||||||||||||||||||||||||||||||||||||||||||||||||||||||||   
    CompleteProfileSummary:
      description: Contains both *unique identifier and nickname of a user
      type: object
      properties:
        userId:
          $ref: "#/components/schemas/CompleteProfilePrototype/properties/nickname"
        nickname:
          $ref: "#/components/schemas/CompleteProfilePrototype/properties/nickname"
      example:
        userId: "Bro9999"
        nickname: "YourBro"
#||||||||||||||||||||||||||||||||||||||||||||||||||||||||   
    CommentIdentifier:
      description: It's a comment *unique* id
      type: object
      properties:
        commentId:
          description: Any number between 0-9999
          type: integer
          format: int64
          minimum: 0
          maximum: 9999
          readOnly: true
          example: 965
      example:
        commentId: 965
#||||||||||||||||||||||||||||||||||||||||||||||||||||||||        
    Comment:
      description: A user's comment contains the text of the comment and the *identifier* of who commented
      type: object
      properties:
        userId: 
          $ref: "#/components/schemas/CompleteProfilePrototype/properties/nickname"
        nickname: 
          $ref: "#/components/schemas/CompleteProfilePrototype/properties/nickname"
        comment:
          type: string
          minLength: 1
          maxLength: 30
          pattern: '^.*?$'
          example: OK my bruh
          description: String value of the comment
        commentId:
          $ref: "#/components/schemas/CommentIdentifier/properties/commentId"
      example:
        userId: "PannaBoy22"
        nickname: "22creammm"
        photo_id: 873
        comment: "Wow che foto spectacularesss"    
        commentId: 16
#||||||||||||||||||||||||||||||||||||||||||||||||||||||||
    RawPhoto:
      description: Image content
      type: object
      properties:
        photoData:
          description: "Raw data of the photo"
          type: string
          minLength: 0
          maxLength: 100
          format: binary
          example: "010110010"
      example: 
        photoData: "010110010"
#||||||||||||||||||||||||||||||||||||||||||||||||||||||||
    Photo:
      description: Contains the essential info of a photo
      type: object
      properties:
        comments:
          description: Array of comments of a photo
          type: array
          minItems: 0
          maxItems: 9999
          items:
            $ref: "#/components/schemas/Comment"
          example:
            - comments:
              - user_id: "miky"
                nickname: "ErMike"
                photo_id: 3821
                comment: "bella foto!"
                comment_id: 23
        likes:
          description:  Array of users that liked a photo
          type: array
          minItems: 0
          maxItems: 9999
          items:
            $ref: "#/components/schemas/CompleteProfileSummary"
          example: 
            -  user_id: "Bro9999"
               nickname: "YourBro"
            -  user_id: "brrrrr"
               nickname: "rkomi"
        date:
          description: Date and time of upload.
          type: string
          format: date-time
          example: 2017-07-21T17:32:28Z
          readOnly: true
        photoId:
          $ref: "#/components/schemas/CommentIdentifier/properties/commentId"
        owner:
          $ref: "#/components/schemas/CompleteProfilePrototype/properties/nickname"
      example: 
        comments:
          - user_id: "miky"
            nickname: "ErMike"
            photo_id: 3821
            comment: "bella foto!"
            comment_id: 99
        likes:
          - user_id: "miky"
            nickname: "ErMike"
        date: 2017-07-21T17:32:28Z
        photoId: 3821
        owner: "Mariucc"
#||||||||||||||||||||||||||||||||||||||||||||||||||||||||      
    Photos:
      description: Represents a list of photos
      type: object
      properties:
        photosList:
          description: List of photos
          type: array
          minItems: 0
          maxItems: 10
          items:
            $ref: "#/components/schemas/Photo"
          example:
            - comments:
                - user_id: "donatello"
                  nickname: "donatello99"
                  photo_id: 8321
                  comment: "wow, nice"
                  comment_id: 7
                - user_id: "raffaello"
                  nickname: "raffaello99"
                  photo_id: 8321
                  comment: "impossible!"
                  comment_id: 76
            - likes:
              - user_id: "donatello"
                nickname: "donatello99"
              - user_id: "raffaello"
                nickname: "raffaello99"
              date: 2017-07-21T17:32:28Z
              photo_id: 8321
              owner: "Sapienzagram"
              
            - comments:
                - user_id: "sfera"
                  nickname: "noNo"
                  photo_id: 7836
                  comment: "bella li"
                  comment_id: 44
                - user_id: "tiziano"
                  nickname: "ferroZ68"
                  photo_id: 7836
                  comment: "spaccaaa"
                  comment_id: 912
            - likes:
              - user_id: "sfera"
                nickname: "ebbasta"
              - user_id: "tiziano"
                nickname: "ferro"
              - user_id: "raffaello"
                nickname: "raffaello99"
              date: 2022-11-22T13:10:14Z
              photo_id: 7836
              owner: "Nerd99"
#||||||||||||||||||||||||||||||||||||||||||||||||||||||||      
    CompleteProfileCollection:
      description: List of users found
      type: object
      properties:
        users:
          description: Array of users with a partial match on the searched nickname
          type: array
          minItems: 0
          maxItems: 10
          items:
            $ref: "#/components/schemas/CompleteProfileSummary"
          example:
            - user_id: Wario21
              nickname: marietto21
            - user_id: Watermelon
              nickname: cocomeros
            - user_id: WaveBruh
              nickname: ondaBro
            - user_id: WantedMan66
              nickname: uomoRicercato
#||||||||||||||||||||||||||||||||||||||||||||||||||||||||  
    CompleteProfile:
          description: Object containing all the profile info
          type: object
          properties:
          
            userId:
              $ref: "#/components/schemas/CompleteProfilePrototype/properties/nickname"
              
            nickname:
              $ref: "#/components/schemas/CompleteProfilePrototype/properties/nickname"
              
            followers:
              description: Array of followers
              type: array
              minItems: 0
              maxItems: 99
              items:
                $ref: "#/components/schemas/CompleteProfileSummary"
              example:
                - user_id: "Wario21"
                  nickname: "warietto21"
                - user_id: "giulio"
                  nickname: "Milioo"

            following:
              description: Array of followed users
              type: array
              minItems: 0
              maxItems: 99
              items:
                $ref: "#/components/schemas/CompleteProfileSummary"
              example:
                - user_id: "giulio"
                  nickname: "Milioo"
                
            photos:
              description: Array of photos
              type: array
              minItems: 0
              maxItems: 10
              items:
                $ref: "#/components/schemas/Photo"
              example:
                - comments:
                  - user_id: "sfera"
                    nickname: "noNo"
                    comment: "bella li"
                    comment_id: 104
                  - user_id: "tiziano"
                    nickname: "ferroZ68"
                    comment: "spaccaaa"
                    comment_id: 99
                - likes:
                  - user_id: "sfera"
                    nickname: "noNo"
                  - user_id: "tiziano"
                    nickname: "ferroZ68"
                  - user_id: "raffaello"
                    nickname: "raffaello99"
                    
                  date: 2022-11-22T13:10:14Z
                  photo_id: 7836
                  owner: "PulpFiction"
#||||||||||||||||||||||||||||||||||||||||||||||||||||||||            
    ConversationsList:
      description: List of conversations (chat peers)
      type: object
      properties:
        conversations:
          description: Array of conversations (direct peers and groups)
          type: array
          minItems: 0
          maxItems: 9999
          items:
            $ref: "#/components/schemas/Conversation"
      required:
        - conversations
      example:
        conversations:
          - peer: "abcdef012345"
            isGroup: false
            name: "Maria"
            photoUrl: "/users/abcdef012345/photo"
            lastMessageAt: 2017-07-21T17:32:28Z
            lastMessagePreview: "Hello!"
#||||||||||||||||||||||||||||||||||||||||||||||||||||||||
    Conversation:
      description: Conversation summary (direct chat or group chat)
      type: object
      properties:
        peer:
          description: Conversation peer identifier (user id or group peer id like g-42)
          type: string
          pattern: '^.*?$'
          minLength: 1
          maxLength: 32
          example: "g-42"
        isGroup:
          description: True if this is a group conversation
          type: boolean
          example: true
        name:
          description: Other user's name or group name
          type: string
          pattern: '^.*?$'
          minLength: 0
          maxLength: 64
          example: "My group"
        photoUrl:
          description: URL for conversation photo (user/group)
          type: string
          pattern: '^.*?$'
          minLength: 0
          maxLength: 256
          example: "/groups/42/photo"
        lastMessageAt:
          description: Timestamp of last message in this conversation
          type: string
          format: date-time
          example: 2017-07-21T17:32:28Z
        lastMessagePreview:
          description: Snippet of last message (or empty)
          type: string
          pattern: '^.*?$'
          minLength: 0
          maxLength: 256
          example: "Hello!"
      required:
        - peer
        - isGroup
        - name
        - photoUrl
        - lastMessageAt
        - lastMessagePreview
      example:
        peer: "g-42"
        isGroup: true
        name: "My group"
        photoUrl: "/groups/42/photo"
        lastMessageAt: 2017-07-21T17:32:28Z
        lastMessagePreview: "Hello!"
#||||||||||||||||||||||||||||||||||||||||||||||||||||||||
    MessagesList:
      description: List of messages in a conversation
      type: object
      properties:
        messages:
          description: Array of messages
          type: array
          minItems: 0
          maxItems: 9999
          items:
            $ref: "#/components/schemas/Message"
      required:
        - messages
      example:
        messages:
          - id: 123
            sender: "abcdef012345"
            receiver: "fedcba543210"
            body: "Hello!"
            date: 2017-07-21T17:32:28Z
#||||||||||||||||||||||||||||||||||||||||||||||||||||||||
    CreateGroup:
      description: Create group request body
      type: object
      properties:
        name:
          description: Group name
          type: string
          minLength: 1
          maxLength: 32
          pattern: '^.*?$'
          example: "My group"
        members:
          description: Array of user identifiers to be added to the group
          type: array
          minItems: 0
          maxItems: 9999
          items:
            type: string
            pattern: '^.*?$'
            minLength: 3
            maxLength: 16
            example: "abcdef012345"
      required:
        - name
      example:
        name: "My group"
        members:
          - "abcdef012345"
#||||||||||||||||||||||||||||||||||||||||||||||||||||||||
    GroupCreated:
      description: Group creation response
      type: object
      properties:
        groupId:
          description: Group unique identifier
          type: integer
          format: int64
          example: 42
          readOnly: true
      required:
        - groupId
      example:
        groupId: 42
#||||||||||||||||||||||||||||||||||||||||||||||||||||||||
    GroupName:
      description: Group name update request body
      type: object
      properties:
        name:
          description: Group name
          type: string
          minLength: 1
          maxLength: 32
          pattern: '^.*?$'
          example: "New group name"
      required:
        - name
      example:
        name: "New group name"
#||||||||||||||||||||||||||||||||||||||||||||||||||||||||
    MessageReaction:
      description: Reaction (emoticon) body
      type: object
      properties:
        reaction:
          description: Reaction emoticon/text
          type: string
          minLength: 1
          maxLength: 16
          pattern: '^.*?$'
          example: "ðŸ˜€"
      required:
        - reaction
      example:
        reaction: "ðŸ˜€"
#||||||||||||||||||||||||||||||||||||||||||||||||||||||||
    MessageReactionItem:
      description: A reaction associated to a message
      type: object
      properties:
        userId:
          description: User identifier that reacted
          type: string
          pattern: '^.*?$'
          minLength: 3
          maxLength: 16
          example: "abcdef012345"
        reaction:
          description: Reaction emoticon/text
          type: string
          minLength: 1
          maxLength: 16
          pattern: '^.*?$'
          example: "ðŸ˜€"
      required:
        - userId
        - reaction
      example:
        userId: "abcdef012345"
        reaction: "ðŸ˜€"
#||||||||||||||||||||||||||||||||||||||||||||||||||||||||
    ForwardMessage:
      description: Forward message request body
      type: object
      properties:
        to:
          description: Target conversation peer identifier (user id or group peer id like g-42)
          type: string
          minLength: 1
          maxLength: 32
          pattern: '^.*?$'
          example: "g-42"
      required:
        - to
      example:
        to: "g-42"
#||||||||||||||||||||||||||||||||||||||||||||||||||||||||
    SendMessage:
      description: Request body to send a message
      type: object
      properties:
        body:
          description: Text content of the message
          type: string
          minLength: 1
          maxLength: 1000
          pattern: '^.*?$'
          example: "Hello!"
      required:
        - body
      example:
        body: "Hello!"
#||||||||||||||||||||||||||||||||||||||||||||||||||||||||
    Message:
      description: A direct chat message
      type: object
      properties:
        id:
          description: Message unique identifier
          type: integer
          format: int64
          example: 123
          readOnly: true
        sender:
          description: Sender user identifier
          type: string
          pattern: '^.*?$'
          minLength: 3
          maxLength: 16
          example: "abcdef012345"
        receiver:
          description: Receiver user identifier
          type: string
          pattern: '^.*?$'
          minLength: 3
          maxLength: 16
          example: "fedcba543210"
        body:
          description: Message body
          type: string
          minLength: 1
          maxLength: 1000
          pattern: '^.*?$'
          example: "Hello!"
        date:
          description: Message timestamp
          type: string
          format: date-time
          example: 2017-07-21T17:32:28Z
          readOnly: true
        status:
          description: Checkmarks status for sent messages (0 none, 1 received, 2 read)
          type: integer
          minimum: 0
          maximum: 2
          example: 2
          readOnly: true
        reactions:
          description: Reactions on this message
          type: array
          minItems: 0
          maxItems: 9999
          items:
            $ref: "#/components/schemas/MessageReactionItem"
      required:
        - id
        - sender
        - receiver
        - body
        - date
      example:
        id: 123
        sender: "abcdef012345"
        receiver: "fedcba543210"
        body: "Hello!"
        date: 2017-07-21T17:32:28Z
        status: 2
        reactions:
          - userId: "fedcba543210"
            reaction: "ðŸ˜€"
#||||||||||||||||||||||||||||||||||||||||||||||||||||||||
    UserLogin:
      description: Username sent by user during the login
      type: object
      properties:
        name:
          $ref: "#/components/schemas/CompleteProfilePrototype/properties/nickname"
      required:
        - name
      example:
        name: Maria
#||||||||||||||||||||||||||||||||||||||||||||||||||||||||          
    LoginReturn:
      description: Identifier returned after the login
      type: object
      properties:
        identifier:
          description: Identifier to be used as Bearer token in Authorization header
          type: string
          example: "abcdef012345"
          pattern: '^.*?$'
          minLength: 3
          maxLength: 16
      required:
        - identifier
#||||||||||||||||||||||||||||||||||||||||||||||||||||||||
    OkResponse:
      description: Generic success payload for operations that don't return a resource representation
      type: object
      properties:
        message:
          description: Human-readable status message
          type: string
          pattern: '^.*?$'
          example: "ok"
      required:
        - message
      example:
        message: "ok"
#||||||||||||||||||||||||||||||||||||||||||||||||||||||||
    ErrorMessage:
      description: Standard error payload
      type: object
      properties:
        message:
          description: Error message
          type: string
          pattern: '^.*?$'
          example: "error"
      required:
        - message
      example:
        message: "error"
#||||||||||||||||||||||||||||||||||||||||||||||||||||||||
#_____________________________________________________________________________________________________  
  responses:
#''''''''''''''''''''''''''''''''''''''''''''''''''''''''
    ok:
      description: Response associated to a 200 http status (OK)
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/OkResponse"
          example:
            message: "ok"
#''''''''''''''''''''''''''''''''''''''''''''''''''''''''
    no_content:
      description: Response associated to the 204 http status (No content to send for this reques)
#''''''''''''''''''''''''''''''''''''''''''''''''''''''''
    bad_request:
      description: Response associated to the 400 http status (Bad request)
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/ErrorMessage"
          example:
            message: "bad request"
#''''''''''''''''''''''''''''''''''''''''''''''''''''''''     
    partial_content:
      description: Response associated to the 206 http status (The requested resource has partial info)
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/CompleteProfile" 
          example:
            user_id: "abcdef0123456789"
            nickname: "Maria"
#''''''''''''''''''''''''''''''''''''''''''''''''''''''''      
    unauthorized:
      description:  Response associated to the 401 http status (Access token is missing. User is not logged in)
# added content to satisfy OpenAPI lint ruleset
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/ErrorMessage"
          example:
            message: "unauthorized"
#''''''''''''''''''''''''''''''''''''''''''''''''''''''''          
    forbidden:
      description: Response associated to the 403 http status (Access denied )
# added content to satisfy OpenAPI lint ruleset
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/ErrorMessage"
          example:
            message: "forbidden"
#''''''''''''''''''''''''''''''''''''''''''''''''''''''''     
    not_found:
      description: Response associated to the 404 http status (The requested resource doesn't exist)
# added content to satisfy OpenAPI lint ruleset
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/ErrorMessage"
          example:
            message: "not found"
#''''''''''''''''''''''''''''''''''''''''''''''''''''''''            
    internal_server_error:
      description: Response associated to the 500 http status (Server has encountered an unknown error)
# added content to satisfy OpenAPI lint ruleset
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/ErrorMessage"
          example:
            message: "internal server error"
#''''''''''''''''''''''''''''''''''''''''''''''''''''''''
    user_found:
      description: There's a match for the given identifier/nickname. User/users found successfully
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/CompleteProfileCollection"
          example:
            users:
              - user_id: "Wario21"
                nickname: "marietto21"
#''''''''''''''''''''''''''''''''''''''''''''''''''''''''          
    stream:
      description: Contains a list of photos from following users in a reversed chronological order
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/Photos"
          example:
            photos_list: []
#''''''''''''''''''''''''''''''''''''''''''''''''''''''''            
    comment_added:
      description: Comment has been added successfully. Returns the comment *unique* identifier
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/CommentIdentifier"
#''''''''''''''''''''''''''''''''''''''''''''''''''''''''            
    photo_uploaded:
      description: photo has been uploaded successfully. Returns the *unique* id of the posted photo
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/RawPhoto"
#''''''''''''''''''''''''''''''''''''''''''''''''''''''''
    profile:
      description: All the info of a profile
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/CompleteProfile"
          example:
            user_id: "abcdef0123456789"
            nickname: "Maria"
#''''''''''''''''''''''''''''''''''''''''''''''''''''''''
    photo:
      description: The binary data of a photo
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/RawPhoto"
#''''''''''''''''''''''''''''''''''''''''''''''''''''''''
#_____________________________________________________________________________________________________
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
#_____________________________________________________________________________________________________