{
  "schema_type": "referenced",
  "description": "Normalized MongoDB schema with separate collections and ObjectId references",
  "collections": {
    "users": {
      "description": "Individual system participants with profile information",
      "sample_document": {
        "_id": "ObjectId('507f1f77bcf86cd799439011')",
        "username": "john_doe",
        "email": "john.doe@example.com",
        "display_name": "John Doe",
        "avatar_url": "https://cdn.wasatext.com/avatars/john_doe.jpg",
        "created_at": "ISODate('2024-01-15T10:30:00Z')",
        "last_activity": "ISODate('2024-02-01T14:22:00Z')",
        "is_online": true,
        "status_message": "Available",
        "preferences": {
          "notifications_enabled": true,
          "theme": "dark",
          "language": "en"
        }
      },
      "indexes": [
        {"username": 1},
        {"email": 1},
        {"last_activity": -1},
        {"created_at": -1}
      ]
    },
    "conversations": {
      "description": "Container entities grouping related messages between participants",
      "sample_document": {
        "_id": "ObjectId('507f1f77bcf86cd799439012')",
        "type": "group",
        "title": "Project Team Discussion",
        "participants": [
          "ObjectId('507f1f77bcf86cd799439011')",
          "ObjectId('507f1f77bcf86cd799439013')",
          "ObjectId('507f1f77bcf86cd799439014')"
        ],
        "created_by": "ObjectId('507f1f77bcf86cd799439011')",
        "created_at": "ISODate('2024-01-20T09:15:00Z')",
        "last_message_at": "ISODate('2024-02-01T16:45:00Z')",
        "message_count": 247,
        "is_archived": false,
        "settings": {
          "mute_notifications": false,
          "allow_invites": true,
          "message_retention_days": 365
        }
      },
      "indexes": [
        {"participants": 1},
        {"last_message_at": -1},
        {"created_at": -1},
        {"type": 1, "is_archived": 1}
      ]
    },
    "messages": {
      "description": "Individual message content and metadata",
      "sample_document": {
        "_id": "ObjectId('507f1f77bcf86cd799439015')",
        "conversation_id": "ObjectId('507f1f77bcf86cd799439012')",
        "sender_id": "ObjectId('507f1f77bcf86cd799439011')",
        "content": "Hey everyone, just wanted to share the latest project updates.",
        "message_type": "text",
        "timestamp": "ISODate('2024-02-01T16:45:00Z')",
        "edited_at": null,
        "reply_to": null,
        "attachments": [],
        "metadata": {
          "client_id": "web-app-v2.1",
          "ip_address": "192.168.1.100",
          "user_agent": "Mozilla/5.0..."
        },
        "is_deleted": false,
        "deletion_timestamp": null
      },
      "indexes": [
        {"conversation_id": 1, "timestamp": -1},
        {"sender_id": 1, "timestamp": -1},
        {"timestamp": -1},
        {"message_type": 1},
        {"conversation_id": 1, "is_deleted": 1}
      ]
    },
    "reactions": {
      "description": "User emotional responses to specific messages",
      "sample_document": {
        "_id": "ObjectId('507f1f77bcf86cd799439016')",
        "message_id": "ObjectId('507f1f77bcf86cd799439015')",
        "user_id": "ObjectId('507f1f77bcf86cd799439013')",
        "reaction_type": "like",
        "timestamp": "ISODate('2024-02-01T16:47:00Z')",
        "is_active": true
      },
      "indexes": [
        {"message_id": 1, "user_id": 1},
        {"message_id": 1, "reaction_type": 1},
        {"user_id": 1, "timestamp": -1}
      ]
    },
    "receipts": {
      "description": "Message delivery and read status tracking",
      "sample_document": {
        "_id": "ObjectId('507f1f77bcf86cd799439017')",
        "message_id": "ObjectId('507f1f77bcf86cd799439015')",
        "user_id": "ObjectId('507f1f77bcf86cd799439014')",
        "status": "read",
        "delivered_at": "ISODate('2024-02-01T16:45:30Z')",
        "read_at": "ISODate('2024-02-01T17:12:00Z')",
        "client_info": {
          "device_type": "mobile",
          "app_version": "1.5.2"
        }
      },
      "indexes": [
        {"message_id": 1, "user_id": 1},
        {"message_id": 1, "status": 1},
        {"user_id": 1, "read_at": -1}
      ]
    }
  },
  "design_principles": {
    "normalization": "Each entity type stored in separate collection",
    "relationships": "ObjectId references maintain entity relationships",
    "consistency": "Application-level referential integrity enforcement",
    "scalability": "Independent scaling of entity collections",
    "query_patterns": "Multiple queries required for complete data retrieval"
  },
  "trade_offs": {
    "advantages": [
      "Consistent document sizes across collections",
      "Reduced data duplication and storage overhead",
      "Efficient updates to individual entities",
      "Clear separation of concerns and maintainability",
      "Flexible querying across entity boundaries"
    ],
    "disadvantages": [
      "Multiple database round trips for complete data",
      "Complex application logic for data aggregation",
      "Potential consistency issues across collections",
      "Join-like operations required at application level",
      "Higher network latency for related data retrieval"
    ]
  }
}
